# Анализ данных бриллиантов: кластеризация, обнаружение аномалий и прогнозирование цен

## Описание проекта
Проект направлен на анализ данных о бриллиантах, включая их физические характеристики и цены. Основные этапы работы:
1. **Исследовательский анализ данных (EDA)**.
2. **Кластеризация** для выявления групп схожих объектов.
3. **Обнаружение аномалий** с использованием трёх методов.
4. **Прогнозирование цен** с помощью моделей машинного обучения.

## Ключевые этапы и результаты

### 1. Предобработка данных
- **Данные**: Датасет `diamonds.csv` (53,940 записей, 10 признаков, включая `carat`, `depth`, `price`, `x`, `y`, `z`).
- **Очистка**: Пропуски отсутствуют. Категориальные признаки (`cut`, `color`, `clarity`) закодированы методом one-hot.
- **Нормализация**: Все числовые признаки масштабированы с помощью `StandardScaler`.

### 2. Визуализация и корреляционный анализ
- **Распределения признаков**: Построены гистограммы для числовых колонок (сохранены в `distributions.png`).
- **Корреляция**: Сильная корреляция обнаружена между:
  - `carat` и `price` (0.92),
  - `carat` и размерами `x`, `y`, `z` (0.95–0.98).

### 3. Кластеризация (KMeans)
- **Оптимальное число кластеров**: Определено методом силуэтта — **2 кластера**.
- **Визуализация**: t-SNE показала чёткое разделение данных на две группы (график сохранён).

### 4. Обнаружение аномалий
- **Методы**:
  1. **IQR**: 3,540 аномалий (выбросы в `price`/`carat`).
  2. **Isolation Forest**: 2,697 аномалий (нестандартные комбинации признаков).
  3. **DBSCAN**: 104 аномалии (редкие объекты).
- **Совпадения**: 24 аномалии обнаружены всеми методами (приоритет для проверки).
- **Визуализация**: Аномалии отмечены на графике `carat` vs `price` (сохранён в `common_anomalies.png`).

### 5. Прогнозирование цен
- **Модели**:
  - Linear Regression: R²=0.919, MAE=737.15.
  - Random Forest: R²=0.961, MAE=398.76.
  - **XGBoost**: Наилучший результат — R²=0.979, MAE=297.72, RMSE=579.61.
- **Важность признаков** (Random Forest):
  - `carat` — 64.8%,
  - `x` — 26.5%.
